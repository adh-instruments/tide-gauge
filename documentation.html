<!DOCTYPE html>
<html lang="id" class="h-full bg-gray-50">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Panduan Pengguna & Perakitan</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><path fill='%230284c7' d='M50 60C30 60 10 70 10 80s20 20 40 20 40-10 40-20-20-20-40-20z' /><rect fill='%23333' x='45' y='15' width='10' height='40'/><circle fill='%23ef4444' cx='50' cy='10' r='10'/></svg>">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" />
    <style>
        body { font-family: 'Inter', sans-serif; }
        .prose h2 { color: #1e3a8a; border-bottom: 2px solid #e5e7eb; padding-bottom: 0.5rem; margin-top: 2rem; margin-bottom: 1rem; }
        .prose h3 { color: #1f2937; margin-top: 1.5rem; margin-bottom: 0.5rem; font-weight: 600; }
        .prose p { margin-bottom: 1rem; line-height: 1.6; color: #4b5563; }
        .prose ul, .prose ol { margin-left: 1.5rem; margin-bottom: 1rem; color: #4b5563; }
        .prose li { margin-bottom: 0.25rem; }
        .step-circle { display: inline-flex; width: 24px; height: 24px; background: #2563eb; color: white; border-radius: 50%; align-items: center; justify-content: center; font-size: 12px; margin-right: 8px; font-weight: bold; }
    </style>
</head>
<body class="h-full flex flex-col">

    <!-- Header -->
    <header class="bg-white border-b border-gray-200 h-16 flex-none flex items-center justify-between px-4 md:px-6 shadow-sm z-30 sticky top-0">
        <div class="flex items-center gap-3 md:gap-4">
            <img src="https://www.unib.ac.id/wp-content/uploads/2019/10/logo-unib-e1571906638799.png" alt="UNIB Logo" class="h-8 md:h-10 w-auto object-contain">
            <div class="hidden md:block h-8 w-px bg-gray-200"></div>
            <h1 class="text-lg md:text-xl font-bold text-gray-800 tracking-tight truncate">
                Panduan <span class="text-blue-600">Teknis</span>
            </h1>
        </div>
        <div class="flex items-center">
            <a href="index.html" class="text-gray-500 hover:text-blue-600 font-medium text-sm flex items-center gap-1 transition-colors">
                &larr; Kembali ke Dashboard
            </a>
        </div>
    </header>

    <div class="flex-1 flex overflow-hidden">
        
        <!-- Sidebar Navigation (Desktop) -->
        <aside class="hidden md:block w-64 bg-gray-50 border-r border-gray-200 overflow-y-auto p-6">
            <nav class="space-y-1">
                <a href="#intro" class="block px-3 py-2 text-sm font-medium text-gray-900 rounded-md bg-white shadow-sm ring-1 ring-gray-200">Pendahuluan</a>
                <a href="#dashboard" class="block px-3 py-2 text-sm font-medium text-gray-600 hover:bg-gray-100 rounded-md">1. Menggunakan Dashboard</a>
                <a href="#csv" class="block px-3 py-2 text-sm font-medium text-gray-600 hover:bg-gray-100 rounded-md">2. Mengolah Data CSV</a>
                <a href="#hardware" class="block px-3 py-2 text-sm font-medium text-gray-600 hover:bg-gray-100 rounded-md">3. Merakit Perangkat</a>
                <a href="#code" class="block px-3 py-2 text-sm font-medium text-gray-600 hover:bg-gray-100 rounded-md">4. Pemrograman (Coding)</a>
                <a href="#database" class="block px-3 py-2 text-sm font-medium text-gray-600 hover:bg-gray-100 rounded-md">5. Setup Database</a>
                <a href="#datascience" class="block px-3 py-2 text-sm font-medium text-blue-600 bg-blue-50 rounded-md">6. Analisis Pasut(Google Colab)</a>
            </nav>
        </aside>

        <!-- Content -->
        <main class="flex-1 overflow-y-auto p-6 md:p-10 scroll-smooth">
            <div class="max-w-4xl mx-auto prose">
                
                <div id="intro" class="mb-10">
                    <h1 class="text-3xl font-bold text-gray-900 mb-4">Dokumentasi & Panduan Sistem Tide Gauge</h1>
                    <p class="text-lg">Selamat datang di halaman dokumentasi. Halaman ini dirancang untuk memandu mahasiswa dalam memahami, menggunakan, dan merakit ulang sistem pemantauan pasang surut air laut (Tide Gauge) berbasis IoT.</p>
                </div>

                <section id="dashboard">
                    <h2 class="text-2xl font-bold">1. Menggunakan Dashboard</h2>
                    <p>Dashboard ini menampilkan data <b>real-time</b> dari sensor yang dipasang di lapangan. Berikut fitur utamanya:</p>
                    <ul class="list-disc pl-5 space-y-2">
                        <li><b>Peta Lokasi:</b> Menampilkan posisi alat. Gunakan checkbox di sidebar kiri untuk menampilkan/menyembunyikan stasiun tertentu.</li>
                        <li><b>Grafik Pasang Surut:</b> Garis biru menunjukkan ketinggian air (cm) terhadap waktu. Data diperbarui otomatis setiap 100ms.</li>
                        <li><b>Status Baterai:</b> Grafik bawah memantau tegangan baterai. Jika tegangan turun di bawah 3.5V, angka akan berwarna merah (perlu penggantian baterai).</li>
                        <li><b>Download CSV:</b> Tombol hijau di pojok kanan tabel untuk mengunduh data ke Excel.</li>
                    </ul>
                </section>

                <section id="csv">
                    <h2 class="text-2xl font-bold">2. Mengolah Data CSV di Excel</h2>
                    <p>File CSV yang diunduh sudah diformat agar mudah dibaca oleh Microsoft Excel. Namun, jika kolom waktu (Timestamp) tidak terbaca otomatis, ikuti langkah ini:</p>
                    <ol class="list-decimal pl-5 space-y-2">
                        <li>Buka file CSV di Excel.</li>
                        <li>Blok kolom <b>A (Timestamp)</b>.</li>
                        <li>Klik menu <b>Data</b> &rarr; <b>Text to Columns</b>.</li>
                        <li>Pilih <b>Delimited</b> &rarr; Next &rarr; Uncheck semua &rarr; Next.</li>
                        <li>Pada "Column Data Format", pilih <b>Date: YMD</b>.</li>
                        <li>Klik <b>Finish</b>. Excel akan mengenali tanggal dan waktu dengan benar.</li>
                    </ol>
                </section>

                <section id="hardware">
                    <h2 class="text-2xl font-bold">3. Merakit Perangkat (Hardware)</h2>
                    <p>Sistem ini menggunakan mikrokontroler <b>Lolin32 Lite (ESP32)</b> dan sensor ultrasonik <b>HC-SR04</b>.</p>
                    
                    <h3 class="text-lg font-bold">Komponen yang Dibutuhkan:</h3>
                    <ul class="list-disc pl-5">
                        <li>Lolin32 Lite (atau ESP32 Dev Module)</li>
                        <li>Sensor Ultrasonik HC-SR04</li>
                        <li>Resistor 100k Ohm (R1) & 100k Ohm (R2) untuk pembagi tegangan baterai.</li>
                        <li>Kabel Jumper & Breadboard/PCB</li>
                    </ul>

                    <h3 class="text-lg font-bold mt-4">Skema Sambungan Kabel (Wiring):</h3>
                    <div class="bg-gray-100 p-4 rounded-lg border border-gray-300 font-mono text-sm overflow-x-auto">
                        <table class="w-full text-left">
                            <thead>
                                <tr class="border-b border-gray-400">
                                    <th class="py-2">Komponen</th>
                                    <th class="py-2">Pin Komponen</th>
                                    <th class="py-2">Pin ESP32 (Lolin32)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="py-2">HC-SR04</td>
                                    <td>VCC</td>
                                    <td>5V / VBUS</td>
                                </tr>
                                <tr>
                                    <td class="py-2">HC-SR04</td>
                                    <td>GND</td>
                                    <td>GND</td>
                                </tr>
                                <tr>
                                    <td class="py-2">HC-SR04</td>
                                    <td><b>Trig</b></td>
                                    <td><b>Pin 14</b></td>
                                </tr>
                                <tr>
                                    <td class="py-2">HC-SR04</td>
                                    <td><b>Echo</b></td>
                                    <td><b>Pin 12</b></td>
                                </tr>
                                <tr class="border-t border-gray-300">
                                    <td class="py-2">Baterai (+)</td>
                                    <td>Positif (+)</td>
                                    <td>Ke Resistor R1 (lalu ke Pin 32)</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <section id="code">
                    <h2 class="text-2xl font-bold">4. Pemrograman (Coding)</h2>
                    <p>Untuk memprogram alat, Anda memerlukan software <b>Arduino IDE</b>.</p>

                    <h3 class="text-lg font-bold">Langkah Persiapan:</h3>
                    <ol class="list-decimal pl-5 space-y-2">
                        <li>Install <a href="https://www.arduino.cc/en/software" target="_blank" class="text-blue-600 underline">Arduino IDE</a>.</li>
                        <li>Buka menu <b>File</b> &rarr; <b>Preferences</b>.</li>
                        <li>Di kotak "Additional Boards Manager URLs", masukkan: <br><code class="bg-gray-100 p-1 text-xs">https://raw.githubusercontent.com/espressif/arduino-esp32/gh-pages/package_esp32_index.json</code></li>
                        <li>Buka <b>Tools</b> &rarr; <b>Board</b> &rarr; <b>Boards Manager</b>. Cari "esp32" dan install versi terbaru.</li>
                        <li>Buka <b>Tools</b> &rarr; <b>Manage Libraries</b>. Cari dan install library: <b>ArduinoJson</b>.</li>
                    </ol>

                    <h3 class="text-lg font-bold mt-6">Source Code (Sketch):</h3>
                    <p>Salin kode di bawah ini ke Arduino IDE. Jangan lupa ubah <code>ssid</code>, <code>password</code>, dan <code>station_id</code> sesuai alat Anda.</p>
                    
                    <div class="relative mt-4">
                        <button onclick="copyCode()" class="absolute top-2 right-2 bg-gray-700 text-white text-xs px-3 py-1 rounded hover:bg-gray-600 z-10">Copy Code</button>
                        <pre><code id="arduino-code" class="language-cpp">
#include <WiFi.h>
#include <HTTPClient.h>
#include <ArduinoJson.h>

// --- KONFIGURASI WIFI ---
const char* ssid = "NAMA_WIFI_ANDA";
const char* password = "PASSWORD_WIFI";

// --- KONFIGURASI SUPABASE ---
const char* supabase_url = "https://urlprojectanda.supabase.co"; // silahkan cari tutorial menggunakan supabase
const char* supabase_key = "eyJ...."; // silahkan cari tutorial menggunakan supabase

// --- IDENTITAS ALAT (GANTI UNTUK SETIAP ALAT) ---
const char* station_id = "tide-01"; // Ganti ke "tide-02" untuk alat kedua

// --- PIN HARDWARE ---
const int trigPin = 14;   // Pin Trigger HC-SR04
const int echoPin = 12;   // Pin Echo HC-SR04
const int voltagePin = 32; // Pin Pembaca Baterai

// Kalibrasi Resistor (Voltage Divider)
const float R1 = 94900.0;
const float R2 = 92100.0;

void setup() {
  Serial.begin(115200);
  
  pinMode(trigPin, OUTPUT);
  pinMode(echoPin, INPUT);

  // Koneksi WiFi
  WiFi.begin(ssid, password);
  Serial.print("Menghubungkan ke WiFi");
  while (WiFi.status() != WL_CONNECTED) {
    delay(500);
    Serial.print(".");
  }
  Serial.println("\nTerhubung!");
}

void loop() {
  float jarak = getAverageDistance();
  float tegangan = readBatteryVoltage();

  Serial.print("ID: "); Serial.println(station_id);
  Serial.print("Jarak: "); Serial.print(jarak); Serial.println(" cm");
  Serial.print("Baterai: "); Serial.print(tegangan); Serial.println(" V");
  
  if (WiFi.status() == WL_CONNECTED) {
    sendData(jarak, tegangan);
  } else {
    Serial.println("WiFi Terputus. Mencoba Reconnect...");
    WiFi.reconnect();
  }

  // Kirim data setiap 1 menit (60000 ms)
  delay(60000); 
}

void sendData(float dist, float batt) {
  HTTPClient http;
  http.begin(supabase_url);
  http.addHeader("apikey", supabase_key);
  http.addHeader("Authorization", String("Bearer ") + supabase_key);
  http.addHeader("Content-Type", "application/json");
  http.addHeader("Prefer", "return=minimal");

  JsonDocument doc;
  doc["station_id"] = station_id;
  doc["distance_cm"] = dist;
  doc["voltage"] = batt;
  
  String jsonString;
  serializeJson(doc, jsonString);

  int responseCode = http.POST(jsonString);
  
  if (responseCode > 0) {
    Serial.print("Data Terkirim! Kode: "); Serial.println(responseCode);
  } else {
    Serial.print("Gagal Kirim: "); Serial.println(responseCode);
  }
  http.end();
}

float getRawDistance() {
  // Manual Trigger HC-SR04 (Tanpa Library)
  digitalWrite(trigPin, LOW);
  delayMicroseconds(2);
  digitalWrite(trigPin, HIGH);
  delayMicroseconds(10);
  digitalWrite(trigPin, LOW);
  
  long duration = pulseIn(echoPin, HIGH);
  float distance = duration * 0.034 / 2;
  return distance;
}

float getAverageDistance() {
  float sum = 0;
  int valid = 0;
  for (int i = 0; i < 5; i++) {
    float d = getRawDistance();
    if (d > 0 && d < 500) { sum += d; valid++; }
    delay(50);
  }
  return (valid > 0) ? (sum / valid) : 0.0;
}

float readBatteryVoltage() {
  float raw = analogRead(voltagePin) * (3.3 / 4095.0);
  return (raw * (R1 + R2)) / R2;
}
                        </code></pre>
                    </div>
                </section>

                <section id="database">
                    <h2 class="text-2xl font-bold">5. Persiapan Database (Supabase)</h2>
                    <p>Jika Anda membuat project baru di Supabase, Anda perlu membuat tabel database agar data bisa masuk. Buka <b>SQL Editor</b> di Supabase dan jalankan perintah berikut:</p>
                    
                    <div class="relative bg-gray-800 rounded-lg p-4 text-gray-100 font-mono text-sm mb-6">
                        <button onclick="copySQL()" class="absolute top-2 right-2 bg-gray-600 hover:bg-gray-500 px-2 py-1 rounded text-xs">Copy SQL</button>
                        <code id="sql-code">
-- 1. Buat Tabel Stasiun (Lokasi)
CREATE TABLE tide_stations (
    station_id TEXT PRIMARY KEY,
    name TEXT,
    latitude FLOAT,
    longitude FLOAT
);

-- 2. Buat Tabel Pembacaan (Sensor Data)
CREATE TABLE tide_readings (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    station_id TEXT REFERENCES tide_stations(station_id),
    distance_cm FLOAT,
    voltage FLOAT,
    created_at TIMESTAMPTZ DEFAULT NOW()
);

-- 3. Masukkan Data Awal Stasiun
INSERT INTO tide_stations (station_id, name, latitude, longitude)
VALUES 
    ('tide-01', 'Stasiun Dermaga Utara', -3.7912, 102.2645),
    ('tide-02', 'Stasiun Muara Selatan', -3.8150, 102.3012);

-- 4. Buka Akses Publik (PENTING!)
ALTER TABLE tide_stations ENABLE ROW LEVEL SECURITY;
ALTER TABLE tide_readings ENABLE ROW LEVEL SECURITY;
CREATE POLICY "Public Access" ON tide_stations FOR ALL USING (true) WITH CHECK (true);
CREATE POLICY "Public Access" ON tide_readings FOR ALL USING (true) WITH CHECK (true);
                        </code>
                    </div>
                </section>

                <section id="datascience" class="pb-20">
                    <h2 class="text-2xl font-bold text-blue-800">6. Analisis Pasut (Google Colab)</h2>
                    <p>Gunakan Google Colab untuk menganalisis periodisitas data pasang surut menggunakan <b>Fast Fourier Transform (FFT)</b>. Notebook ini otomatis memisahkan data berdasarkan <i>Station ID</i> dan menampilkan grafik domain periode (Periodogram).</p>

                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-6 mb-6">
                        <h3 class="text-lg font-bold text-blue-900 mt-0">Cara Menggunakan:</h3>
                        <ol class="list-decimal pl-5 space-y-2 text-blue-800">
                            <li>Download file Notebook (.ipynb) menggunakan tombol di bawah.</li>
                            <li>Buka <a href="https://colab.research.google.com" target="_blank" class="underline font-bold">Google Colab</a>.</li>
                            <li>Pilih tab <b>"Upload"</b> dan pilih file yang baru saja didownload.</li>
                            <li>Di Dashboard ini, klik tombol hijau <b>"Download CSV"</b> untuk mendapatkan data terbaru.</li>
                            <li>Di Google Colab, jalankan sel pertama (tombol Play). Upload file CSV Anda saat diminta.</li>
                            <li>Notebook akan otomatis memproses semua stasiun dan menampilkan grafik analisis.</li>
                        </ol>
                        
                        <div class="mt-6">
                            <button onclick="downloadNotebook()" class="bg-orange-600 hover:bg-orange-700 text-white font-bold py-3 px-6 rounded-lg shadow-lg flex items-center gap-2 transition-transform active:scale-95">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                                </svg>
                                Download Notebook (.ipynb)
                            </button>
                        </div>
                    </div>
                </section>

            </div>
        </main>
    </div>

    <script>
        function copyCode() {
            const code = document.getElementById('arduino-code').innerText;
            navigator.clipboard.writeText(code).then(() => {
                alert("Kode berhasil disalin!");
            });
        }
        function copySQL() {
            const code = document.getElementById('sql-code').innerText;
            navigator.clipboard.writeText(code).then(() => {
                alert("SQL berhasil disalin!");
            });
        }

        function downloadNotebook() {
            const notebookContent = {
                "cells": [
                    {
                        "cell_type": "markdown",
                        "metadata": {},
                        "source": [
                            "# Analisis Periodisitas Pasang Surut (FFT)\n",
                            "Notebook ini melakukan Transformasi Fourier Cepat (FFT) pada data pasang surut untuk mengidentifikasi siklus dominan (misalnya siklus 12 jam atau 24 jam).\n",
                            "\n",
                            "**Fitur:**\n",
                            "- Otomatis mendeteksi semua Station ID.\n",
                            "- Resampling data agar interval waktu seragam (syarat FFT).\n",
                            "- Menghitung Periodogram (Amplitudo vs Periode).\n",
                            "\n",
                            "**Cara Pakai:**\n",
                            "1. Jalankan sel di bawah.\n",
                            "2. Upload file CSV dari dashboard."
                        ]
                    },
                    {
                        "cell_type": "code",
                        "execution_count": null,
                        "metadata": {},
                        "outputs": [],
                        "source": [
                            "import pandas as pd\n",
                            "import numpy as np\n",
                            "import matplotlib.pyplot as plt\n",
                            "from scipy.fft import rfft, rfftfreq\n",
                            "from google.colab import files\n",
                            "import io\n",
                            "\n",
                            "# 1. Upload File\n",
                            "print('Silakan upload file CSV Anda...')\n",
                            "uploaded = files.upload()\n",
                            "filename = next(iter(uploaded))\n",
                            "\n",
                            "# 2. Baca Data\n",
                            "try:\n",
                            "    df = pd.read_csv(io.BytesIO(uploaded[filename]))\n",
                            "    # Bersihkan nama kolom (hapus spasi)\n",
                            "    df.columns = [c.strip() for c in df.columns]\n",
                            "    \n",
                            "    # Deteksi kolom otomatis\n",
                            "    time_col = next((c for c in df.columns if 'time' in c.lower() or 'timestamp' in c.lower()), None)\n",
                            "    id_col = next((c for c in df.columns if 'station' in c.lower() and 'id' in c.lower()), 'Station ID')\n",
                            "    val_col = next((c for c in df.columns if 'dist' in c.lower() or 'level' in c.lower()), 'Distance (cm)')\n",
                            "\n",
                            "    if not (time_col and id_col and val_col):\n",
                            "        print('Error: Kolom Waktu/ID/Nilai tidak ditemukan secara otomatis.')\n",
                            "        print('Kolom yang ada:', df.columns)\n",
                            "    else:\n",
                            "        # Konversi waktu\n",
                            "        df[time_col] = pd.to_datetime(df[time_col])\n",
                            "        \n",
                            "        # Cari unik ID Stasiun\n",
                            "        stations = df[id_col].unique()\n",
                            "        print(f\"\\nDitemukan {len(stations)} stasiun: {stations}\\n\")\n",
                            "\n",
                            "        # Loop untuk setiap stasiun\n",
                            "        for station in stations:\n",
                            "            print(f\"--- Menganalisis Stasiun: {station} ---\")\n",
                            "            \n",
                            "            # Filter data stasiun ini & urutkan waktu\n",
                            "            sub_df = df[df[id_col] == station].sort_values(by=time_col)\n",
                            "            \n",
                            "            if len(sub_df) < 50:\n",
                            "                print(f\"Data terlalu sedikit ({len(sub_df)} baris). Melewati analisis FFT.\\n\")\n",
                            "                continue\n",
                            "\n",
                            "            # Resample ke interval 15 menit (FFT butuh interval tetap)\n",
                            "            sub_df = sub_df.set_index(time_col)\n",
                            "            # Hapus duplikat index jika ada\n",
                            "            sub_df = sub_df[~sub_df.index.duplicated(keep='first')]\n",
                            "            \n",
                            "            # Resample 15T (15 menit) dan interpolasi data kosong\n",
                            "            resampled = sub_df[val_col].resample('15T').mean().interpolate(method='linear')\n",
                            "            \n",
                            "            # Siapkan Data FFT\n",
                            "            y = resampled.values\n",
                            "            N = len(y)\n",
                            "            T = 15 * 60 # 15 menit dalam detik\n",
                            "            \n",
                            "            # Detrending (Kurangi rata-rata agar tidak ada peak di 0 Hz)\n",
                            "            y_detrended = y - np.mean(y)\n",
                            "            \n",
                            "            # Hitung FFT\n",
                            "            yf = rfft(y_detrended)\n",
                            "            xf = rfftfreq(N, T)\n",
                            "            \n",
                            "            # Konversi Frekuensi ke Periode (Jam)\n",
                            "            with np.errstate(divide='ignore'):\n",
                            "                periods = (1 / xf) / 3600 # detik ke jam\n",
                            "            \n",
                            "            # Hitung Amplitudo\n",
                            "            amplitude = 2.0/N * np.abs(yf)\n",
                            "            \n",
                            "            # Filter tampilan grafik (hanya periode 2 jam s.d. 30 jam)\n",
                            "            mask = (periods >= 2) & (periods <= 30)\n",
                            "            \n",
                            "            # --- PLOTTING ---\n",
                            "            fig, (ax1, ax2) = plt.subplots(2, 1, figsize=(10, 8))\n",
                            "            \n",
                            "            # Plot 1: Time Series\n",
                            "            ax1.plot(resampled.index, resampled.values, label='Data (Resampled)', color='tab:blue')\n",
                            "            ax1.set_title(f'Time Series: {station}')\n",
                            "            ax1.set_ylabel('Jarak/Level (cm)')\n",
                            "            ax1.grid(True)\n",
                            "            \n",
                            "            # Plot 2: Periodogram\n",
                            "            ax2.plot(periods[mask], amplitude[mask], color='tab:red')\n",
                            "            ax2.set_title(f'Analisis Periodisitas (FFT): {station}')\n",
                            "            ax2.set_xlabel('Periode (Jam)')\n",
                            "            ax2.set_ylabel('(Amplitudo)')\n",
                            "            ax2.set_xlim(0, 30)\n",
                            "            ax2.grid(True)\n",
                            "            \n",
                            "            # Tandai Peak Utama (Dominan)\n",
                            "            peak_idx = np.argmax(amplitude[mask])\n",
                            "            peak_period = periods[mask][peak_idx]\n",
                            "            peak_amp = amplitude[mask][peak_idx]\n",
                            "            ax2.annotate(f'Peak: {peak_period:.1f} Jam', \n",
                            "                         xy=(peak_period, peak_amp), \n",
                            "                         xytext=(peak_period+2, peak_amp), \n",
                            "                         arrowprops=dict(facecolor='black', shrink=0.05))\n",
                            "\n",
                            "            plt.tight_layout()\n",
                            "            plt.show()\n",
                            "            print('\\n')\n",
                            "\n",
                            "except Exception as e:\n",
                            "    print(f'Terjadi kesalahan: {e}')"
                        ]
                    }
                ],
                "metadata": {
                    "kernelspec": {
                        "display_name": "Python 3",
                        "language": "python",
                        "name": "python3"
                    },
                    "language_info": {
                        "codemirror_mode": {
                            "name": "ipython",
                            "version": 3
                        },
                        "file_extension": ".py",
                        "mimetype": "text/x-python",
                        "name": "python",
                        "nbconvert_exporter": "python",
                        "pygments_lexer": "ipython3",
                        "version": "3.8.5"
                    }
                },
                "nbformat": 4,
                "nbformat_minor": 4
            };

            const blob = new Blob([JSON.stringify(notebookContent, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'analisis_tide_unib.ipynb';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }
    </script>
</body>
</html>
